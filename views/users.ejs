<%- include('partials/adminHeader', { title: 'Users' }) %>
  <%- include('partials/adminNav', { title: 'Users' }) %>

    <main class="container section">
      <div class="panel">
        <h2>Create User</h2>
        <p class="note">For Teacher accounts, the email must match the teacher record and a class must be assigned.</p>
        <% if (error) { %>
          <div class="alert error">
            <%= error %>
          </div>
          <% } %>
            <% if (success) { %>
              <div class="alert success">
                <%= success %>
              </div>
              <% } %>
                <form action="/dashboard/users" method="POST" class="form grid-form">
                  <input type="text" name="name" placeholder="Full Name" required />
                  <input type="email" name="email" placeholder="Email Address" required />
                  <input type="password" name="password" placeholder="Temporary Password" required />
                  <select name="role" required>
                    <option value="">Select Role</option>
                    <% roles.forEach((role)=> { %>
                      <option value="<%= role %>">
                        <%= role.charAt(0).toUpperCase() + role.slice(1) %>
                      </option>
                      <% }) %>
                  </select>
                  <button class="btn" type="submit">Create User</button>
                </form>
      </div>

      <div class="panel">
        <h2>Users List</h2>
        <div class="table-wrapper">
          <table class="table">
            <thead>
              <tr>
                <th>Name</th>
                <th>Email</th>
                <th>Role</th>
                <th>Created</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <% if (!users.length) { %>
                <tr>
                  <td colspan="5">No users found.</td>
                </tr>
                <% } %>
                  <% users.forEach((account)=> { %>
                    <tr>
                      <td>
                        <%= account.name %>
                      </td>
                      <td>
                        <%= account.email %>
                      </td>
                      <td><span class="badge badge-primary">
                          <%= account.role %>
                        </span></td>
                      <td>
                        <%= account.created_at %>
                      </td>
                      <td>
                        <form action="/dashboard/users/<%= account.id %>/delete" method="POST"
                          onsubmit="return confirm('Delete this user?');">
                          <button class="btn btn-danger" type="submit">Delete</button>
                        </form>
                      </td>
                    </tr>
                    <% }) %>
            </tbody>
          </table>
        </div>
      </div>
    </main>

    <%- include('partials/adminFooter') %>