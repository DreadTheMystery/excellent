<%- include('partials/adminHeader', { title: 'Admissions' }) %>
  <%- include('partials/adminNav', { title: 'Admissions' }) %>

    <main class="container section">
      <div class="panel">
        <h2>Admission Applications</h2>
        <div class="table-wrapper">
          <table class="table">
            <thead>
              <tr>
                <th>Student</th>
                <th>Class</th>
                <th>Parent</th>
                <th>Contact</th>
                <th>Status</th>
                <th>Submitted</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody>
              <% if (!applications.length) { %>
                <tr>
                  <td colspan="6">No applications yet.</td>
                </tr>
                <% } %>
                  <% applications.forEach((app)=> { %>
                    <tr>
                      <td>
                        <%= app.student_name %>
                      </td>
                      <td>
                        <%= app.class_applied %>
                      </td>
                      <td>
                        <%= app.parent_name %>
                      </td>
                      <td>
                        <div>
                          <%= app.parent_phone %>
                        </div>
                        <div>
                          <%= app.parent_email %>
                        </div>
                      </td>
                      <td><span
                          class="badge <%= app.status === 'approved' ? 'badge-success' : app.status === 'rejected' ? 'badge-warning' : 'badge-primary' %>">
                          <%= app.status %>
                        </span></td>
                      <td>
                        <%= app.created_at %>
                      </td>
                      <td>
                        <form action="/dashboard/admissions/<%= app.id %>/status" method="POST" class="form"
                          style="gap:0.5rem;">
                          <select name="status" required>
                            <option value="pending" <%=app.status==='pending' ? 'selected' : '' %>>Pending</option>
                            <option value="approved" <%=app.status==='approved' ? 'selected' : '' %>>Approved</option>
                            <option value="rejected" <%=app.status==='rejected' ? 'selected' : '' %>>Rejected</option>
                            <option value="waitlist" <%=app.status==='waitlist' ? 'selected' : '' %>>Waitlist</option>
                          </select>
                          <input type="text" name="note" placeholder="Optional note" />
                          <button class="btn" type="submit">Send</button>
                        </form>
                      </td>
                    </tr>
                    <% }) %>
            </tbody>
          </table>
        </div>
      </div>
    </main>

    <%- include('partials/adminFooter') %>